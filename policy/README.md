## Provenance verification with Open Policy Agent (OPA)

### Description

Here, we have a simple REGO file which runs some checks against our provenance attestation. The signature verification is **NOT** done by OPA, we assume that it was done in a previous step using `cosign` or a similar tool.
We have two policies:
- One for provenance
- One for SBOM

What we do here is just check that the statement has a predicateType of `https://slsa.dev/provenance/v1` to verify that it is indeed a provenance statement. After that, we need to set our expectations for verification. We know beforehand that the attestation the we will feed into the OPA Engine is generated by our GitHub pipeline. That's why, for our case, we set some constant expectations like the `approved_repos` or `approved_runners`.

Similarly, for the SBOM, we know that we have an expressjs app, that's why the policy checks that the version of the policy is greater than 4 (no particular reason, just for demo purposes).